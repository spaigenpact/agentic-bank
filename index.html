<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>iOS TTS Test</title>
</head>
<body>
  <h1>iOS Text-to-Speech Test</h1>
  <p>This page tests speech synthesis on iOS Safari. Tap the screen (to unlock audio), then tap <strong>Speak</strong>.</p>
  
  <!-- Button the user will tap to hear speech -->
  <button id="speak-btn">Speak</button>
  
  <script>
    /**
     * 1) Unlock audio for iOS Safari on the first touch
     *    iOS often blocks audio (including speech synthesis) until
     *    there's a direct user gesture. This code plays an empty
     *    utterance to "unlock" audio for future speak() calls.
     */
    function unlockAudioForiOS() {
      const emptyUtterance = new SpeechSynthesisUtterance('');
      speechSynthesis.speak(emptyUtterance);
      window.removeEventListener('touchstart', unlockAudioForiOS);
    }
    window.addEventListener('touchstart', unlockAudioForiOS, { once: true });

    /**
     * 2) Minimal speech synthesis on button click
     *    Tapping Speak should now produce audible output
     *    if the device isn't in silent mode and media volume is up.
     */
    document.getElementById('speak-btn').addEventListener('click', () => {
      const utterance = new SpeechSynthesisUtterance("Hello from a minimal test!");
      utterance.lang = 'en-US';
      utterance.onstart = () => console.log("Speech started");
      utterance.onend = () => console.log("Speech ended");
      
      speechSynthesis.speak(utterance);
    });
  </script>
</body>
</html>
